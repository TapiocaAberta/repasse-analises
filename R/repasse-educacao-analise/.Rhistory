cor.test(anos_finais_e$REPASSE_MATRICULA, anos_finais_e$IDEB_NOTA, method = "pearson")
cor.test(anos_finais_f$REPASSE_MATRICULA, anos_finais_f$IDEB_NOTA, method = "pearson")
cor.test(anos_finais_g$REPASSE_MATRICULA, anos_finais_g$IDEB_NOTA, method = "pearson")
load(file = "../../data/ideb_repasse/fundeb/todos_anos.RData")
faixa_a <- ideb_repasse %>% dplyr::filter(FAIXA_POP == "A")
faixa_b <- ideb_repasse %>% dplyr::filter(FAIXA_POP == "B")
faixa_c <- ideb_repasse %>% dplyr::filter(FAIXA_POP == "C")
faixa_d <- ideb_repasse %>% dplyr::filter(FAIXA_POP == "D")
faixa_e <- ideb_repasse %>% dplyr::filter(FAIXA_POP == "E")
faixa_f <- ideb_repasse %>% dplyr::filter(FAIXA_POP == "F")
faixa_g <- ideb_repasse %>% dplyr::filter(FAIXA_POP == "G")
cor.test(ideb_repasse$IDEB_NOTA, ideb_repasse$IDHM, method = "pearson")
cor.test(ideb_repasse$IDEB_NOTA, ideb_repasse$IDH_EDUCACAO, method = "pearson")
cor.test(ideb_repasse$IDEB_NOTA, ideb_repasse$IDH_RENDA, method = "pearson")
cor.test(ideb_repasse$IDEB_NOTA, ideb_repasse$IDH_LONGEVIDADE, method = "pearson")
col_num <- c(7:11, 18, 20)
data_num_fin <- ideb_repasse[, col_num]
correlations_fin <- cor(data_num_fin)
corrplot(correlations_fin, method = "circle")
load(file = "../../data/ideb_repasse/fundeb/todos_anos.RData")
sp <- ideb_repasse %>% dplyr::filter(UF == "SP")
View(sp)
ap <- ideb_repasse %>% dplyr::filter(UF == "AP")
ap <- ideb_repasse %>% dplyr::filter(UF == "AP")
load(file = "../../data/ideb_repasse/fundeb/todos_anos.RData")
AC <- ideb_repasse %>% dplyr::filter(UF == "AC")
AP <- ideb_repasse %>% dplyr::filter(UF == "AP")
AM <- ideb_repasse %>% dplyr::filter(UF == "AM")
RO <- ideb_repasse %>% dplyr::filter(UF == "RO")
RR <- ideb_repasse %>% dplyr::filter(UF == "RR")
TO <- ideb_repasse %>% dplyr::filter(UF == "TO")
AL <- ideb_repasse %>% dplyr::filter(UF == "AL")
BA <- ideb_repasse %>% dplyr::filter(UF == "BA")
CE <- ideb_repasse %>% dplyr::filter(UF == "CE")
MA <- ideb_repasse %>% dplyr::filter(UF == "MA")
PB <- ideb_repasse %>% dplyr::filter(UF == "PB")
PI <- ideb_repasse %>% dplyr::filter(UF == "PI")
PE <- ideb_repasse %>% dplyr::filter(UF == "PE")
RN <- ideb_repasse %>% dplyr::filter(UF == "RN")
SE <- ideb_repasse %>% dplyr::filter(UF == "SE")
DF <- ideb_repasse %>% dplyr::filter(UF == "DF")
GO <- ideb_repasse %>% dplyr::filter(UF == "GO")
MT <- ideb_repasse %>% dplyr::filter(UF == "MT")
MS <- ideb_repasse %>% dplyr::filter(UF == "MS")
ES <- ideb_repasse %>% dplyr::filter(UF == "ES")
SP <- ideb_repasse %>% dplyr::filter(UF == "SP")
MG <- ideb_repasse %>% dplyr::filter(UF == "MG")
RJ <- ideb_repasse %>% dplyr::filter(UF == "RJ")
PR <- ideb_repasse %>% dplyr::filter(UF == "PR")
RS <- ideb_repasse %>% dplyr::filter(UF == "RS")
SC <- ideb_repasse %>% dplyr::filter(UF == "SC")
save(SP, file = "../../data/ideb_repasse/fundeb/estado/SP.RData")
save(SP, file = "../../data/ideb_repasse/fundeb/estado/SP.RData")
save(SP, file = "../../data/ideb_repasse/fundeb/estado/SP.csv")
write.csv(SP,"../../data/ideb_repasse/fundeb/estado/SP.csv", row.names = FALSE)
write.csv(SP,"../../data/ideb_repasse/fundeb/estado/SP.csv")
View(SP)
write.csv(SP,"../../data/ideb_repasse/fundeb/estado/SP.csv", sep = ",", quote = "\"")
write.csv(SP,"../../data/ideb_repasse/fundeb/estado/SP.csv", sep = ",")
write.csv(SP,"../../data/ideb_repasse/fundeb/estado/SP.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "SC"), "../../data/ideb_repasse/fundeb/estado/SC.csv")
load(file = "../../data/ideb_repasse/fundeb/todos_anos.RData")
write.csv(ideb_repasse %>% dplyr::filter(UF == "AC"), "../../data/ideb_repasse/fundeb/estado/AC.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "AP"), "../../data/ideb_repasse/fundeb/estado/AP.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "AM"), "../../data/ideb_repasse/fundeb/estado/AM.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "RO"), "../../data/ideb_repasse/fundeb/estado/RO.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "RR"), "../../data/ideb_repasse/fundeb/estado/RR.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "TO"), "../../data/ideb_repasse/fundeb/estado/TO.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "AL"), "../../data/ideb_repasse/fundeb/estado/AL.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "BA"), "../../data/ideb_repasse/fundeb/estado/BA.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "CE"), "../../data/ideb_repasse/fundeb/estado/CE.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "MA"), "../../data/ideb_repasse/fundeb/estado/MA.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "PB"), "../../data/ideb_repasse/fundeb/estado/PB.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "PI"), "../../data/ideb_repasse/fundeb/estado/PI.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "PE"), "../../data/ideb_repasse/fundeb/estado/PE.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "RN"), "../../data/ideb_repasse/fundeb/estado/RN.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "SE"), "../../data/ideb_repasse/fundeb/estado/SE.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "DF"), "../../data/ideb_repasse/fundeb/estado/DF.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "GO"), "../../data/ideb_repasse/fundeb/estado/GO.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "MT"), "../../data/ideb_repasse/fundeb/estado/MT.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "MS"), "../../data/ideb_repasse/fundeb/estado/MS.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "ES"), "../../data/ideb_repasse/fundeb/estado/ES.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "SP"), "../../data/ideb_repasse/fundeb/estado/SP.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "MG"), "../../data/ideb_repasse/fundeb/estado/MG.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "RJ"), "../../data/ideb_repasse/fundeb/estado/RJ.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "PR"), "../../data/ideb_repasse/fundeb/estado/PR.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "RS"), "../../data/ideb_repasse/fundeb/estado/RS.csv")
write.csv(ideb_repasse %>% dplyr::filter(UF == "SC"), "../../data/ideb_repasse/fundeb/estado/SC.csv")
gc()
library("PerformanceAnalytics")
library("corrplot")
library("ggpubr")
library("ggplot2")
load(file = "../../data/ideb_repasse/todos_anos.RData")
load(file = "../../data/ideb_repasse/anos_iniciais.RData")
load(file = "../../data/ideb_repasse/anos_finais.RData")
load(file = "../../data/ideb_repasse/ensino_medio.RData")
#load(file = "../../data/ideb_repasse/ideb_media.RData")
View(ideb_repasse)
col_num <- c(7:11, 18, 20)
data_num_ini <- anos_iniciais[, col_num]
correlations_ini <- cor(data_num_ini)
col_num <- c(7:11, 18, 20)
data_num_ini <- anos_iniciais[, col_num]
correlations_ini <- cor(data_num_ini)
corrplot(correlations_ini, method = "circle")
View(anos_iniciais)
col_num <- c(6:10, 14, 17)
data_num_ini <- anos_iniciais[, col_num]
correlations_ini <- cor(data_num_ini)
corrplot(correlations_ini, method = "circle")
remove(ensino_medio)
remove(correlations_ini)
View(ideb_repasse)
remove(ideb_repasse)
remove(data_num_ini)
load(file = "../../data/ideb_repasse/fundeb/anos_iniciais.RData")
load(file = "../../data/ideb_repasse/fundeb/anos_finais.RData")
fundamenta <- rbind(anos_finais, anos_iniciais)
delete(fundamenta)
delete(fundamenta)
remove(fundamenta)
fundamental <- rbind(anos_finais, anos_iniciais)
col_num <- c(6:10, 14, 17)
data_fundamental <- fundamental[, col_num]
View(data_fundamental)
remove(data_fundamental)
View(fundamental)
remove(col_num)
colnames(ideb_repasse)
colnames(fundamental)
cols <- c("IDEB_NOTA", "IDHM", "IDH_EDUCACAO", "IDH_LONGEVIDADE",
"IDH_RENDA", "REPASSE_MATRICULA", "POPULACAO", "MATRICULA")
data_fundamental <- fundamental[, cols]
View(data_fundamental)
cor_ideb_fundeb <- cor(data_fundamental[, c("IDEB_NOTA", "REPASSE_MATRICULA")])
cor_ideb_fundeb <- cor(data_fundamental[, c("IDEB_NOTA", "REPASSE_MATRICULA")])
corrplot(cor_ideb_fundeb, method="number")
cor_ideb_idhs <- cor(data_fundamental[, c("IDEB_NOTA", "IDHM", "IDH_EDUCACAO", "IDH_LONGEVIDADE",
"IDH_RENDA")])
corrplot(cor_ideb_idhs, method="number")
cor_ideb_idhs <- cor(data_fundamental[, c("IDEB_NOTA", "IDHM", "IDH_EDUCACAO", "IDH_LONGEVIDADE",
"IDH_RENDA")], method = "pearson")
corrplot(cor_ideb_idhs, method="number")
load(file = "../../data/ideb_repasse/fundeb/todos_anos.RData")
View(ideb_repasse)
remove(ideb_repasse)
load(file = "../../data/ideb_repasse/fundeb/anos_iniciais.RData")
col_num <- c("IDEB_NOTA", "IDHM", "IDH_EDUCACAO", "IDH_LONGEVIDADE",
"IDH_RENDA", "REPASSE_MATRICULA", "POPULACAO", "MATRICULA")
data_num_ini <- anos_iniciais[, col_num]
data_num_ini <- anos_iniciais[, col_num]
correlations_ini <- cor(data_num_ini)
corrplot(correlations_ini, method = "number")
correlations_ini <- cor(data_num_ini[, c("IDEB_NOTA", "REPASSE_MATRICULA")])
corrplot(correlations_ini, method = "number")
load(file = "../../data/ideb_repasse/fundeb/anos_finais.RData")
col_num <- c("IDEB_NOTA", "IDHM", "IDH_EDUCACAO", "IDH_LONGEVIDADE",
"IDH_RENDA", "REPASSE_MATRICULA", "POPULACAO", "MATRICULA")
data_num_fin <- anos_finais[, col_num]
correlations_fin <- cor(data_num_fin[, c("IDEB_NOTA", "REPASSE_MATRICULA")])
corrplot(correlations_fin, method = "number")
load(file = "../../data/ideb_repasse/fundeb/anos_iniciais.RData")
load(file = "../../data/ideb_repasse/fundeb/anos_finais.RData")
fundamental <- rbind(anos_finais, anos_iniciais)
library(ggplot2)
library(viridis)
library(plotly)
faixa_a <- fundamental %>% dplyr::filter(FAIXA_POP == "A")
faixa_b <- fundamental %>% dplyr::filter(FAIXA_POP == "B")
faixa_c <- fundamental %>% dplyr::filter(FAIXA_POP == "C")
faixa_d <- fundamental %>% dplyr::filter(FAIXA_POP == "D")
faixa_e <- fundamental %>% dplyr::filter(FAIXA_POP == "E")
faixa_f <- fundamental %>% dplyr::filter(FAIXA_POP == "F")
faixa_g <- fundamental %>% dplyr::filter(FAIXA_POP == "G")
cor.test(fundamental$IDEB_NOTA, fundamental$IDHM, method = "pearson")
cor.test(fundamental$IDEB_NOTA, fundamental$IDH_EDUCACAO, method = "pearson")
cor.test(fundamental$IDEB_NOTA, fundamental$IDH_RENDA, method = "pearson")
cor.test(fundamental$IDEB_NOTA, fundamental$IDH_LONGEVIDADE, method = "pearson")
cor.test(faixa_a$IDHM, faixa_a$IDEB_NOTA, method = "pearson")
cor.test(faixa_a$IDH_EDUCACAO, faixa_a$IDEB_NOTA, method = "pearson")
cor.test(faixa_a$IDH_RENDA, faixa_a$IDEB_NOTA, method = "pearson")
cor.test(faixa_a$IDH_LONGEVIDADE, faixa_a$IDEB_NOTA, method = "pearson")
cor.test(faixa_b$IDHM, faixa_b$IDEB_NOTA, method = "pearson")
cor.test(faixa_b$IDH_EDUCACAO, faixa_b$IDEB_NOTA, method = "pearson")
cor.test(faixa_b$IDH_RENDA, faixa_b$IDEB_NOTA, method = "pearson")
cor.test(faixa_b$IDH_LONGEVIDADE, faixa_b$IDEB_NOTA, method = "pearson")
cor.test(faixa_c$IDHM, faixa_c$IDEB_NOTA, method = "pearson")
cor.test(faixa_c$IDH_EDUCACAO, faixa_c$IDEB_NOTA, method = "pearson")
cor.test(faixa_c$IDH_RENDA, faixa_c$IDEB_NOTA, method = "pearson")
cor.test(faixa_c$IDH_LONGEVIDADE, faixa_c$IDEB_NOTA, method = "pearson")
cor.test(faixa_d$IDHM, faixa_d$IDEB_NOTA, method = "pearson")
cor.test(faixa_d$IDH_EDUCACAO, faixa_d$IDEB_NOTA, method = "pearson")
cor.test(faixa_d$IDH_RENDA, faixa_d$IDEB_NOTA, method = "pearson")
cor.test(faixa_d$IDH_LONGEVIDADE, faixa_d$IDEB_NOTA, method = "pearson")
cor.test(faixa_e$IDHM, faixa_e$IDEB_NOTA, method = "pearson")
cor.test(faixa_e$IDH_EDUCACAO, faixa_e$IDEB_NOTA, method = "pearson")
cor.test(faixa_e$IDH_RENDA, faixa_e$IDEB_NOTA, method = "pearson")
cor.test(faixa_e$IDH_LONGEVIDADE, faixa_e$IDEB_NOTA, method = "pearson")
cor.test(faixa_f$IDHM, faixa_f$IDEB_NOTA, method = "pearson")
cor.test(faixa_f$IDH_EDUCACAO, faixa_f$IDEB_NOTA, method = "pearson")
cor.test(faixa_f$IDH_RENDA, faixa_f$IDEB_NOTA, method = "pearson")
cor.test(faixa_f$IDH_LONGEVIDADE, faixa_f$IDEB_NOTA, method = "pearson")
cor.test(faixa_g$IDHM, faixa_g$IDEB_NOTA, method = "pearson")
cor.test(faixa_g$IDH_EDUCACAO, faixa_g$IDEB_NOTA, method = "pearson")
cor.test(faixa_g$IDH_RENDA, faixa_g$IDEB_NOTA, method = "pearson")
cor.test(faixa_g$IDH_LONGEVIDADE, faixa_g$IDEB_NOTA, method = "pearson")
load(file = "../../data/ideb_repasse/fundeb/anos_iniciais.RData")
load(file = "../../data/ideb_repasse/fundeb/anos_finais.RData")
fundamental <- rbind(anos_finais, anos_iniciais)
library("tidyverse") #pacote para manipulacao de dados
library("cluster") #algoritmo de cluster
library("dendextend") #compara dendogramas
library("factoextra") #algoritmo de cluster e visualizacao
library("fpc") #algoritmo de cluster e visualizacao
library("gridExtra") #para a funcao grid arrange
View(fundamental)
load(file = "../../data/ideb_repasse/ideb_media.RData")
View(ideb_media)
remove(ideb_media)
remove(fundamental)
View(anos_iniciais)
cols <- c("IDEB_NOTA", "IDHM", "IDH_EDUCACAO", "IDH_LONGEVIDADE", "CODIGO_MUNICIPIO",
"IDH_RENDA", "REPASSE_MATRICULA", "POPULACAO", "MATRICULA", "FAIXA_POP", "REGIAO")
data_ini <- anos_iniciais
View(data_ini)
data_ini <- anos_iniciais[, cols]
View(data_ini)
View(anos_iniciais)
data_ini <- anos_iniciais[, cols]
data_ini <- anos_iniciais[, cols]
View(data_ini)
View(data_ini)
View(anos_iniciais)
cols <- c("ANO_IDEB", "IDEB_NOTA", "IDHM", "IDH_EDUCACAO", "IDH_LONGEVIDADE", "CODIGO_MUNICIPIO",
"IDH_RENDA", "REPASSE_MATRICULA", "POPULACAO", "MATRICULA", "FAIXA_POP", "REGIAO")
data_ini <- anos_iniciais[, cols]
View(data_ini)
rownames(data_ini) <- paste(data_ini$ANO_IDEB, data_ini$CODIGO_MUNICIPIO, sep = "-")
data_ini <- data_ini[,-c("ANO_IDEB", "CODIGO_MUNICIPIO")]
View(data_ini)
data_ini <- data_ini[,-c(1,6)]
View(data_ini)
data.padronized <- (scale(data_ini))
cols <- c("ANO_IDEB", "IDEB_NOTA", "IDHM", "IDH_EDUCACAO", "IDH_LONGEVIDADE", "CODIGO_MUNICIPIO",
"IDH_RENDA", "REPASSE_MATRICULA", "POPULACAO", "MATRICULA")
data_ini <- anos_iniciais[, cols]
rownames(data_ini) <- paste(data_ini$ANO_IDEB, data_ini$CODIGO_MUNICIPIO, sep = "-")
data_ini <- data_ini[,-c(1,6)]
data.padronized <- (scale(data_ini))
fviz_nbclust(data.padronized, kmeans, method = "wss")
k4_ini <- kmeans(data.padronized, centers = 4)
View(k4_ini)
fviz_cluster(k4_ini, data = data.padronized, main = "Cluster K4", geom = c("point"))
datafit_ini <- data.frame(k4_ini$cluster)
anos_iniciais <-  cbind(anos_iniciais, datafit_ini)
View(anos_iniciais)
anos_iniciais_k1 <- anos_iniciais %>% dplyr::filter(k4_ini == 1)
anos_iniciais_k1 <- anos_iniciais %>% dplyr::filter(k4_ini == "1")
View(anos_iniciais)
anos_iniciais_k1 <- anos_iniciais %>% dplyr::filter(anos_iniciais$k4_ini.cluster == "1")
View(anos_iniciais_k1)
anos_iniciais_k2 <- anos_iniciais %>% dplyr::filter(k4_ini.cluster == "2")
anos_iniciais_k3 <- anos_iniciais %>% dplyr::filter(k4_ini.cluster == "3")
anos_iniciais_k4 <- anos_iniciais %>% dplyr::filter(k4_ini.cluster == "4")
summary(anos_iniciais_k1)
summary(anos_iniciais_k2)
sapply(anos_iniciais_k1, function(x) c(summary(x), type = class(x)))
x <- sapply(anos_iniciais_k1, function(x) c(summary(x), type = class(x)))
View(x)
write.csv(x, file = '../../data/ideb_repasse/fundeb/varsum.csv')
x <- sapply(anos_iniciais_k1, function(x) c(summary(x), type = class(x)))
write.csv(x, file = '../../data/ideb_repasse/fundeb/varsum.csv')
summary(anos_iniciais_k1)
summary(anos_iniciais_k2)
summary(anos_iniciais_k1)
summary(anos_iniciais_k1)
summary(anos_iniciais_k2)
summary(anos_iniciais_k3)
summary(anos_iniciais_k4)
cor_k1_ini <- cor(anos_iniciais_k1[, c("IDEB_NOTA", "REPASSE_MATRICULA")], method = "pearson")
corrplot(cor_k1_ini, method="number")
View(cor_k1_ini)
cor_k2_ini <- cor(anos_iniciais_k2[, c("IDEB_NOTA", "REPASSE_MATRICULA")], method = "pearson")
corrplot(cor_k2_ini, method="number")
corrplot(cor_k2_ini, method="number")
View(cor_k2_ini)
cor_k3_ini <- cor(anos_iniciais_k3[, c("IDEB_NOTA", "REPASSE_MATRICULA")], method = "pearson")
View(cor_k3_ini)
corrplot(cor_k3_ini, method="number")
cor_k4_ini <- cor(anos_iniciais_k4[, c("IDEB_NOTA", "REPASSE_MATRICULA")], method = "pearson")
corrplot(cor_k4_ini, method="number")
cor.test(cor_k1_ini$REPASSE_MATRICULA, cor_k1_ini$IDEB_NOTA, method = "pearson")
cor.test(anos_iniciais_k1$REPASSE_MATRICULA, anos_iniciais_k1$IDEB_NOTA, method = "pearson")
cor.test(anos_iniciais_k2$REPASSE_MATRICULA, anos_iniciais_k2$IDEB_NOTA, method = "pearson")
cor.test(anos_iniciais_k3$REPASSE_MATRICULA, anos_iniciais_k3$IDEB_NOTA, method = "pearson")
cor.test(anos_iniciais_k4$REPASSE_MATRICULA, anos_iniciais_k4$IDEB_NOTA, method = "pearson")
View(anos_iniciais_k3)
##################################################################################
load(file = "../../data/ideb_repasse/fundeb/anos_iniciais.RData")
load(file = "../../data/ideb_repasse/fundeb/anos_finais.RData")
anos_iniciais$REGIAO = as.factor(anos_iniciais$REGIAO)
anos_finais$REGIAO = as.factor(anos_finais$REGIAO)
cols <- c("ANO_IDEB", "IDEB_NOTA", "IDHM", "IDH_EDUCACAO", "IDH_LONGEVIDADE", "CODIGO_MUNICIPIO",
"IDH_RENDA", "REPASSE_MATRICULA", "POPULACAO", "MATRICULA")
data_ini <- anos_iniciais[, cols]
rownames(data_ini) <- paste(data_ini$ANO_IDEB, data_ini$CODIGO_MUNICIPIO, sep = "-")
data_ini <- data_ini[,-c(1,6)]
data.padronized <- (scale(data_ini))
k4_ini <- kmeans(data.padronized, centers = 4)
fviz_cluster(k4_ini, data = data.padronized, main = "Cluster K4", geom = c("point"))
datafit_ini <- data.frame(k4_ini$cluster)
anos_iniciais <-  cbind(anos_iniciais, datafit_ini)
##################################################################################
anos_iniciais_k1 <- anos_iniciais %>% dplyr::filter(k4_ini.cluster == "1")
summary(anos_iniciais_k1)
ggplot(anos_iniciais, aes(anos_iniciais$IDEB_NOTA, anos_iniciais$REPASSE_MATRICULA, color = anos_iniciais$k4_ini.cluster
)) + geom_point()
ggplot(anos_iniciais, aes(anos_iniciais$REPASSE_MATRICULA, anos_iniciais$IDEB_NOTA, color = anos_iniciais$k4_ini.cluster
)) + geom_point()
plotcluster(anos_iniciais, datafit_ini$cluster)
plotcluster(anos_iniciais, anos_iniciais$k4_ini.cluster)
plotcluster(anos_iniciais, k4_ini$cluster)
plotcluster(data.padronized, k4_ini$cluster)
aggregate(data.padronized,by=list(k4_ini$cluster),FUN=mean)
plotcluster(data.padronized, k4_ini$cluster)
set.seed(42)
load(file = "../../data/ideb_repasse/fundeb/anos_iniciais.RData")
load(file = "../../data/ideb_repasse/fundeb/anos_finais.RData")
anos_iniciais$REGIAO = as.factor(anos_iniciais$REGIAO)
anos_finais$REGIAO = as.factor(anos_finais$REGIAO)
cols <- c("ANO_IDEB", "IDEB_NOTA", "IDHM", "IDH_EDUCACAO", "IDH_LONGEVIDADE", "CODIGO_MUNICIPIO",
"IDH_RENDA", "REPASSE_MATRICULA", "POPULACAO", "MATRICULA")
o
data_ini <- anos_iniciais[, cols]
rownames(data_ini) <- paste(data_ini$ANO_IDEB, data_ini$CODIGO_MUNICIPIO, sep = "-")
data_ini <- data_ini[,-c(1,6)]
data.padronized <- (scale(data_ini))
k4_ini <- kmeans(data.padronized, centers = 4)
fviz_cluster(k4_ini, data = data.padronized, main = "Cluster K4", geom = c("point"))
datafit_ini <- data.frame(k4_ini$cluster)
anos_iniciais <-  cbind(anos_iniciais, datafit_ini)
plotcluster(data.padronized, k4_ini$cluster)
##################################################################################
anos_iniciais_k1 <- anos_iniciais %>% dplyr::filter(k4_ini.cluster == "1")
summary(anos_iniciais_k1)
cor_k1_ini <- cor(anos_iniciais_k1[, c("IDEB_NOTA", "REPASSE_MATRICULA")], method = "pearson")
corrplot(cor_k1_ini, method="number")
cor.test(anos_iniciais_k1$REPASSE_MATRICULA, anos_iniciais_k1$IDEB_NOTA, method = "pearson")
##################################################################################
anos_iniciais_k2 <- anos_iniciais %>% dplyr::filter(k4_ini.cluster == "2")
summary(anos_iniciais_k2)
cor_k2_ini <- cor(anos_iniciais_k2[, c("IDEB_NOTA", "REPASSE_MATRICULA")], method = "pearson")
corrplot(cor_k2_ini, method="number")
cor.test(anos_iniciais_k2$REPASSE_MATRICULA, anos_iniciais_k2$IDEB_NOTA, method = "pearson")
##################################################################################
anos_iniciais_k3 <- anos_iniciais %>% dplyr::filter(k4_ini.cluster == "3")
summary(anos_iniciais_k3)
cor_k3_ini <- cor(anos_iniciais_k3[, c("IDEB_NOTA", "REPASSE_MATRICULA")], method = "pearson")
corrplot(cor_k3_ini, method="number")
cor.test(anos_iniciais_k3$REPASSE_MATRICULA, anos_iniciais_k3$IDEB_NOTA, method = "pearson")
##################################################################################
anos_iniciais_k4 <- anos_iniciais %>% dplyr::filter(k4_ini.cluster == "4")
summary(anos_iniciais_k4)
cor_k4_ini <- cor(anos_iniciais_k4[, c("IDEB_NOTA", "REPASSE_MATRICULA")], method = "pearson")
corrplot(cor_k4_ini, method="number")
cor.test(anos_iniciais_k4$REPASSE_MATRICULA, anos_iniciais_k4$IDEB_NOTA, method = "pearson")
plotcluster(data.padronized, k4_ini$cluster)
set.seed(42)
load(file = "../../data/ideb_repasse/fundeb/anos_iniciais.RData")
load(file = "../../data/ideb_repasse/fundeb/anos_finais.RData")
anos_iniciais$REGIAO = as.factor(anos_iniciais$REGIAO)
anos_finais$REGIAO = as.factor(anos_finais$REGIAO)
cols <- c("ANO_IDEB", "IDEB_NOTA", "IDHM", "IDH_EDUCACAO", "IDH_LONGEVIDADE", "CODIGO_MUNICIPIO",
"IDH_RENDA", "REPASSE_MATRICULA", "POPULACAO", "MATRICULA")
data_ini <- anos_iniciais[, cols]
rownames(data_ini) <- paste(data_ini$ANO_IDEB, data_ini$CODIGO_MUNICIPIO, sep = "-")
data_ini <- data_ini[,-c(1,6)]
data.padronized <- (scale(data_ini))
k4_ini <- kmeans(data.padronized, centers = 4)
fviz_cluster(k4_ini, data = data.padronized, main = "Cluster K4", geom = c("point"))
datafit_ini <- data.frame(k4_ini$cluster)
anos_iniciais <-  cbind(anos_iniciais, datafit_ini)
plotcluster(data.padronized, k4_ini$cluster)
##################################################################################
anos_iniciais_k1 <- anos_iniciais %>% dplyr::filter(k4_ini.cluster == "1")
summary(anos_iniciais_k1)
##################################################################################
anos_iniciais_k2 <- anos_iniciais %>% dplyr::filter(k4_ini.cluster == "2")
summary(anos_iniciais_k2)
##################################################################################
anos_iniciais_k3 <- anos_iniciais %>% dplyr::filter(k4_ini.cluster == "3")
summary(anos_iniciais_k3)
##################################################################################
anos_iniciais_k4 <- anos_iniciais %>% dplyr::filter(k4_ini.cluster == "4")
summary(anos_iniciais_k4)
summary(anos_iniciais_k3)
summary(anos_iniciais_k2)
summary(anos_iniciais_k1)
fviz_nbclust(data.padronized, kmeans, method = "wss") +
geom_vline(xintercept = 3, linetype = 2)
set.seed(42)
load(file = "../../data/ideb_repasse/fundeb/anos_iniciais.RData")
load(file = "../../data/ideb_repasse/fundeb/anos_finais.RData")
anos_iniciais$REGIAO = as.factor(anos_iniciais$REGIAO)
anos_finais$REGIAO = as.factor(anos_finais$REGIAO)
cols <- c("ANO_IDEB", "IDEB_NOTA", "IDHM", "IDH_EDUCACAO", "IDH_LONGEVIDADE", "CODIGO_MUNICIPIO",
"IDH_RENDA", "REPASSE_MATRICULA", "POPULACAO", "MATRICULA")
data_ini <- anos_iniciais[, cols]
rownames(data_ini) <- paste(data_ini$ANO_IDEB, data_ini$CODIGO_MUNICIPIO, sep = "-")
data_ini <- data_ini[,-c(1,6)]
data.padronized <- (scale(data_ini))
k4_ini <- kmeans(data.padronized, centers = 3)
fviz_cluster(k4_ini, data = data.padronized, main = "Cluster K3", geom = c("point"))
datafit_ini <- data.frame(k4_ini$cluster)
anos_iniciais <-  cbind(anos_iniciais, datafit_ini)
plotcluster(data.padronized, k4_ini$cluster)
View(anos_iniciais)
##################################################################################
anos_iniciais_k1 <- anos_iniciais %>% dplyr::filter(k4_ini.cluster == "1")
summary(anos_iniciais_k1)
##################################################################################
anos_iniciais_k2 <- anos_iniciais %>% dplyr::filter(k4_ini.cluster == "2")
summary(anos_iniciais_k2)
##################################################################################
anos_iniciais_k3 <- anos_iniciais %>% dplyr::filter(k4_ini.cluster == "3")
summary(anos_iniciais_k3)
gc()
load(file = "../../data/ideb_repasse/fundeb/anos_finais.RData")
data_fin <- anos_finais[, cols]
cols <- c("ANO_IDEB", "IDEB_NOTA", "IDHM", "IDH_EDUCACAO", "IDH_LONGEVIDADE", "CODIGO_MUNICIPIO",
"IDH_RENDA", "REPASSE_MATRICULA", "POPULACAO", "MATRICULA")
data_fin <- anos_finais[, cols]
rownames(data_fin) <- paste(data_fin$ANO_IDEB, data_fin$CODIGO_MUNICIPIO, sep = "-")
data_fin <- data_fin[,-c(1,6)]
data.padronized <- (scale(data_fin))
k3_fin <- kmeans(data.padronized, centers = 3)
fviz_cluster(k3_fin, data = data.padronized, main = "Cluster K3", geom = c("point"))
datafit_fin <- data.frame(k3_fin$cluster)
anos_finais <-  cbind(anos_finais, datafit_fin)
plotcluster(data.padronized, k3_fin$cluster)
##################################################################################
anos_finais_k1 <- anos_finais %>% dplyr::filter(k3_fin.cluster == "1")
summary(anos_finais_k1)
anos_iniciais$REGIAO = as.factor(anos_iniciais$REGIAO)
anos_finais$REGIAO = as.factor(anos_finais$REGIAO)
anos_finais$REGIAO = as.factor(anos_finais$REGIAO)
##################################################################################
anos_finais_k1 <- anos_finais %>% dplyr::filter(k3_fin.cluster == "1")
summary(anos_finais_k1)
##################################################################################
anos_finais_k2 <- anos_finais %>% dplyr::filter(k3_fin.cluster == "2")
summary(anos_finais_k2)
##################################################################################
anos_finais_k3 <- anos_finais %>% dplyr::filter(k3_fin.cluster == "3")
summary(anos_finais_k3)
load(file = "../../data/ideb_repasse/fundeb/anos_iniciais.RData")
anos_iniciais$REGIAO = as.factor(anos_iniciais$REGIAO)
cols <- c("ANO_IDEB", "IDEB_NOTA", "IDHM", "IDH_EDUCACAO", "IDH_LONGEVIDADE", "CODIGO_MUNICIPIO",
"IDH_RENDA", "REPASSE_MATRICULA", "POPULACAO", "MATRICULA")
data_ini <- anos_iniciais[, cols]
rownames(data_ini) <- paste(data_ini$ANO_IDEB, data_ini$CODIGO_MUNICIPIO, sep = "-")
data_ini <- data_ini[,-c(1,6)]
data.padronized <- (scale(data_ini))
k4_ini <- kmeans(data.padronized, centers = 3)
fviz_cluster(k4_ini, data = data.padronized, main = "Cluster K3", geom = c("point"))
datafit_ini <- data.frame(k4_ini$cluster)
anos_iniciais <-  cbind(anos_iniciais, datafit_ini)
anos_iniciais <-  cbind(anos_iniciais, datafit_ini)
##################################################################################
anos_iniciais_k1 <- anos_iniciais %>% dplyr::filter(k4_ini.cluster == "1")
##################################################################################
anos_iniciais_k1 <- anos_iniciais %>% dplyr::filter(k4_ini.cluster == "1")
library("tidyverse") #pacote para manipulacao de dados
library("cluster") #algoritmo de cluster
library("dendextend") #compara dendogramas
library("factoextra") #algoritmo de cluster e visualizacao
library("fpc") #algoritmo de cluster e visualizacao
library("gridExtra") #para a funcao grid arrange
set.seed(42)
##################################################################################
anos_iniciais_k1 <- anos_iniciais %>% dplyr::filter(k4_ini.cluster == "1")
data_ini <- anos_iniciais[, cols]
rownames(data_ini) <- paste(data_ini$ANO_IDEB, data_ini$CODIGO_MUNICIPIO, sep = "-")
data_ini <- data_ini[,-c(1,6)]
data.padronized <- (scale(data_ini))
k4_ini <- kmeans(data.padronized, centers = 3)
fviz_cluster(k4_ini, data = data.padronized, main = "Cluster K3", geom = c("point"))
datafit_ini <- data.frame(k4_ini$cluster)
anos_iniciais <-  cbind(anos_iniciais, datafit_ini)
plotcluster(data.padronized, k4_ini$cluster)
##################################################################################
anos_iniciais_k1 <- anos_iniciais %>% dplyr::filter(k4_ini.cluster == "1")
set.seed(42)
load(file = "../../data/ideb_repasse/fundeb/anos_iniciais.RData")
load(file = "../../data/ideb_repasse/fundeb/anos_finais.RData")
anos_iniciais$REGIAO = as.factor(anos_iniciais$REGIAO)
anos_finais$REGIAO = as.factor(anos_finais$REGIAO)
cols <- c("ANO_IDEB", "IDEB_NOTA", "IDHM", "IDH_EDUCACAO", "IDH_LONGEVIDADE", "CODIGO_MUNICIPIO",
"IDH_RENDA", "REPASSE_MATRICULA", "POPULACAO", "MATRICULA")
data_ini <- anos_iniciais[, cols]
rownames(data_ini) <- paste(data_ini$ANO_IDEB, data_ini$CODIGO_MUNICIPIO, sep = "-")
data_ini <- data_ini[,-c(1,6)]
data.padronized <- (scale(data_ini))
k4_ini <- kmeans(data.padronized, centers = 3)
fviz_cluster(k4_ini, data = data.padronized, main = "Cluster K3", geom = c("point"))
datafit_ini <- data.frame(k4_ini$cluster)
anos_iniciais <-  cbind(anos_iniciais, datafit_ini)
plotcluster(data.padronized, k4_ini$cluster)
##################################################################################
anos_iniciais_k1 <- anos_iniciais %>% dplyr::filter(k4_ini.cluster == "1")
summary(anos_iniciais_k1)
